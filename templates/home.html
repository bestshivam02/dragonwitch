{% extends 'base.html' %}
{% load static %}
{% block content %}

  <!-- carousel start------------ -->
  <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
    <!-- <div class="carousel-indicators">
      <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active"
        aria-current="true" aria-label="Slide 1"></button>
      <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1"
        aria-label="Slide 2"></button>
      <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2"
        aria-label="Slide 3"></button>
    </div> -->
    <div class="carousel-inner">
      {% if main_carousel %}
      {% for each in main_carousel%}
        {% if forloop.counter0|divisibleby:"3" %}
          <div class="carousel-item active">
        {% else %}
          <div class="carousel-item">
        {% endif %}

        <a href="{{ each.redirect_link }}"><img src="{{ each.image.url }}" class="d-block w-100" alt="..."></a>
        <div class="carousel-caption-1 d-none d-md-block">
          <p class="caption-text">{{ each.description }}</p>
          <h1>50% off on Men's Tshirts</h1>
          <p class="caption-text-2">Lorem ipsum dolor sit amet, consectetur adipiscing elit sed do eiusmod tempor
            incididunt ut labore et dolore magnc</p>
          <a href="{{ each.redirect_link }}"><button type="button" value="shop">Shop the Collection</button></a>
        </div>
      </div>

      {% endfor %}
      {% endif %}
      </div>
      <!-- <div class="carousel-item">
        <img src="{% static './images/Image Banner.png' %}" class="d-block w-100" alt="...">
        <div class="carousel-caption-1 d-none d-md-block">
          <p class="caption-text">Denwear Exclusive Men's Deal</p>
          <h1>50% off on Men's Tshirts</h1>
          <p class="caption-text-2">Lorem ipsum dolor sit amet, consectetur adipiscing elit sed do eiusmod tempor
            incididunt ut labore et dolore magnc</p>
          <button type="button" value="shop">Shop the Collection</button>
        </div>
      </div>
      <div class="carousel-item">
        <img src="{% static './images/Image Banner.png' %}" class="d-block w-100" alt="...">
        <div class="carousel-caption-1 d-none d-md-block">
          <p class="caption-text">Denwear Exclusive Men's Deal</p>
          <h1>50% off on Men's Tshirts</h1>
          <p class="caption-text-2">Lorem ipsum dolor sit amet, consectetur adipiscing elit sed do eiusmod tempor
            incididunt ut labore et dolore magnc</p>
          <button type="button" value="shop">Shop the Collection</button>
        </div>
      </div> -->
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions"
        data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions"
        data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
    <!-- carousel end-------------- -->
    <div class="saperator p-4"></div>
    <!-- cards------------ -->
    <section>
      <div class="container">
        <div class="row cards-display">
          {% if sale_banner %}
          {% for each in sale_banner%}
          <div class="col-md-4 col-sm-4 col-lg-4 col-xs-4 my-3 width-card">
            <a href="{{ each.redirect_link }}" class="card main-card m-auto">
              <img class="card-img-top" src="{{ each.image.url }}" alt="Card image cap" />
              <div class="card-body">
                <p class="banner">{{ each.description }}</p>
                <p class="small-text d-inline-block">{{ each.discounts }} OFF</p>
                <i class="pl-5 fas fa-angle-right"></i>
              </div>
            </a>
          </div>
          {% endfor %}
          {% endif %}

          <!-- <div class="col-md-6 col-sm-6 col-lg-4 col-xs-4 my-3 width-card">
            <div class="card main-card m-auto">
              <img class="card-img-top" src="{% static './images/Put image here(2).png' %}" alt="Card image cap" />
              <div class="card-body">
                <p class="banner">Holi Sale 12-16th Mar</p>
                <p class="small-text d-inline-block">50-60% OFF</p>
                <i class="pl-5 fas fa-angle-right"></i>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-sm-6 col-lg-4 col-xs-4 my-3 width-card">
            <div class="card main-card m-auto">
              <img class="card-img-top" src="{% static './images/Put image here(3).png' %}" alt="Card image cap" />
              <div class="card-body">
                <p class="banner">Holi Sale 12-16th Mar</p>
                <p class="small-text d-inline-block">50-60% OFF</p>
                <i class="pl-5 fas fa-angle-right"></i>
              </div>
            </div>
          </div> -->
        </div>
      </div>
    </section>
    <!-- clothe slider--------- -->
    <section id="collection-1">
      <svg aria-hidden="true" style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <defs>
          <symbol id="icon-cross" viewBox="0 0 32 32">
            <title>close</title>
            <path d="M31.7 25.7L22 16l9.7-9.7a1 1 0 0 0 0-1.4L27.1.3a1 1 0 0 0-1.4 0L16 10 6.3.3a1 1 0 0 0-1.4 0L.3 4.9a1 1 0 0 0 0 1.4L10 16 .3 25.7a1 1 0 0 0 0 1.4l4.6 4.6a1 1 0 0 0 1.4 0L16 22l9.7 9.7a1 1 0 0 0 1.4 0l4.6-4.6a1 1 0 0 0 0-1.4z"/>
          </symbol>
        </defs>
      </svg>

      <div class="page" data-modal-state="closed">
        <div class="container">
          <div class="row">
            <div class="col-lg-6"><span class="latest-coll">Our Latest Collection</span></div>
           
          </div>  
          
          <div class="card-slider">
            {% if products %}
              {% for each_product in products %}
                <div class="card-wrapper col-md-4 col-lg-4 col-sm-4">
                  <div class="card card-border">
                  <div class="wishlist-card-icon">
                    {% if request.user.is_authenticated %}
                        {% if each_product.wish_list %}
                            <button class="product-slider__fav js-fav" id='wishlist{{each_product.id}}' onclick="heart_wishlist(this,'{{ each_product.name }}','{{ each_product.id }}')"><span class="heart is-active"></span></button>
                        {% else %}
                            <button class="product-slider__fav js-fav" id='wishlist{{each_product.id}}' onclick="heart_wishlist(this,'{{ each_product.name }}','{{ each_product.id }}')"><span class="heart"></span></button>
                        {% endif %}
                    {% else %}
                        <button data-bs-toggle="modal" data-bs-target="#exampleModal" class="product-slider__fav js-fav" id='wishlist{{each_product.id}}' ><span class="heart"></span></button>
                    {% endif %}
                  </div>
                  <a href="{% url 'frontend:each_products' each_product.id %}"><img class="card-img-top bg-image" src="{{ each_product.image.url }}" alt="Card image cap"></a>
                  <div>
                    <div>
                      <span class="top-card-text">3 Color Options</span>
                      <span class="star-images" style="float:right;">
                        {% with ''|center:each_product.rating_star as range %}
                              {% for i in range %}
                                <i class="fas fa-star"></i>
                              {% endfor %}
                          {% endwith %}  
                          {% with ''|center:each_product.zero_rating_star as negative_range %}
                              {% for i in negative_range %}
                              <i class="far fa-star"></i>
                              {% endfor %}
                          {% endwith %}
                      </span>
                    </div>
                    <hr>
                  </div>
                  <div>
                    <a  class="card-text img-text pro_name" href="{% url 'frontend:each_products' each_product.id %}">{{each_product.name}}</a>
                  </div>
                  <div>
                    <p><span>₹{{each_product.discount_price}}</span><span style="float:right;"><i class="fas fa-shopping-bag"></i></span></p>
                  </div>
                </div>
              </div>
              {% endfor %}
            {% endif %}
          </div>
        </div>
      </div>
    </section>

  <!-- count dowan  -->
    <section class="bg-time">
      <div class="count-dowan">
        <div class="container">
          <div class="row">
            {% if sale_counter %}
              {% for each in sale_counter %}
              <script>
                  document.sale_end_date = "{{ each.sale_end_date|date:'Y-m-d H:i:s' }}";
              </script>
                <div class="col-md-6">
                  <div class="counter">
                    <div class="box">
                      <div class="allTime">
                        <div class="wp days"></div>
                        <div class="wp hrs"></div>
                        <div class="wp min"></div>
                        <div class="wp sec"></div>
                      </div>
                      <div id="timer"></div>
                    </div>
                  </div>
                  <div class="counter-content">
                    <a style = "text-decoration: none;" href="{% url 'frontend:each_products' each.product_detail.id %}"><h2>
                      DEAL OF THE DAY
                    </h2></a>
                    <a style = "text-decoration: none;" href="{% url 'frontend:each_products' each.product_detail.id %}"><h6>
                      {{ each.product_detail.name }}
                    </h6></a>

                    <div class=" text-center ratee">
                      <span class="fa fa-star checked"></span>
                      <span class="fa fa-star checked"></span>
                      <span class="fa fa-star checked"></span>
                      <span class="fa fa-star checked"></span>
                      <span class="fa fa-star checked"></span>
                    </div>

                    <div class="price text-center">
                      <span class="pre-price"><del>₹{{ each.product_detail.price }}</del></span>
                      <span class="end-price">₹{{ each.product_detail.discount_price }}</span>
                      <div class="shop-buttoncus-1">
                        <a class="text-center dafadfj " href="{% url 'frontend:each_products' each.product_detail.id %}">Shop Now</a>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 r-image">
                  <img src="{{ each.image.url }}" alt="" srcset="">
                  <span class="sub-image"> 
                    <img src="{% static './images/dgsa.png' %}" alt="" srcset="">
                  </span>
                </div>
              {% endfor %}
            {% endif %}
          </div>
        </div>
      </div>
    </section>

    <!-- Recommendation Section -->
    <!-- Recommendation Section -->
    <section id="recommend">
      <svg aria-hidden="true" style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <defs>
          <symbol id="icon-cross" viewBox="0 0 32 32">
            <title>close</title>
            <path d="M31.7 25.7L22 16l9.7-9.7a1 1 0 0 0 0-1.4L27.1.3a1 1 0 0 0-1.4 0L16 10 6.3.3a1 1 0 0 0-1.4 0L.3 4.9a1 1 0 0 0 0 1.4L10 16 .3 25.7a1 1 0 0 0 0 1.4l4.6 4.6a1 1 0 0 0 1.4 0L16 22l9.7 9.7a1 1 0 0 0 1.4 0l4.6-4.6a1 1 0 0 0 0-1.4z"/>
          </symbol>
        </defs>
      </svg>
      
      <div class="page" data-modal-state="closed">
        <div class="container">
          <div class="row">
            <div class="col-lg-6">
              <span class="latest-coll">Top Recommendations</span>
            </div>
            <div class="col-lg-6">
              <div class="text-right gg_sec"> 
                <p>Featured Products</p>
                <span>Customized Products</span>
              </div>
            </div>
          </div>
          <div class="card-slider">
            {% if products %}
              {% for each in products %}

                <div class="card-wrapper col-md-4 col-lg-4 col-sm-4">
                  <div class="card card-border">
                  <div class="wishlist-card-icon" >
                    {% if request.user.is_authenticated %}
                        {% if each.wish_list %}
                            <button class="product-slider__fav js-fav" id='wishlist{{each.id}}' onclick="heart_wishlist(this,'{{ each.name }}','{{ each.id }}')"><span class="heart is-active"></span></button>
                        {% else %}
                            <button class="product-slider__fav js-fav" id='wishlist{{each.id}}' onclick="heart_wishlist(this,'{{ each.name }}','{{ each.id }}')"><span class="heart"></span></button>
                        {% endif %}
                    {% else %}
                        <button data-bs-toggle="modal" data-bs-target="#exampleModal" class="product-slider__fav js-fav" id='wishlist{{each.id}}' ><span class="heart"></span></button>
                    {% endif %}
                    </div>
                    <a href="{% url 'frontend:each_products' each.id %}"><img class="card-img-top bg-image" src="{{ each.image.url }}" alt="Card image cap"></a>
                    <div>
                      <div>
                        <span class="top-card-text">3 Color Options</span>
                        <span class="star-images" style="float:right;">
                          {% with ''|center:each.rating_star as range %}
                              {% for i in range %}
                                <i class="fas fa-star"></i>
                              {% endfor %}
                          {% endwith %}  
                          {% with ''|center:each.zero_rating_star as negative_range %}
                              {% for i in negative_range %}
                              <i class="far fa-star"></i>
                              {% endfor %}
                          {% endwith %}
                        </span>
                      </div>
                      <hr>
                    </div>
                    <div >
                      <a  class="card-text img-text pro_name" href="{% url 'frontend:each_products' each.id %}">{{each.name}}</a>
                    </div>
                    <div>
                      <p><span>₹ {{each.discount_price}}</span><span style="float:right;"><i class="fas fa-shopping-bag"></i></span></p>
                    </div>
                  </div>
                </div>
              {% endfor %}
            {% endif %}
          </div>
        </div>
      </div>
    </section>

  <!-- Men Wear Section -->
    <section class="men_wear_sec">
      <div class="container">
        <div class="row mt-5">
          {% if category_banner %}
            {% for each in category_banner|slice:":1" %}
                <div class="col-md-12 col-sm-12 col-lg-6 col-xs-12 mb-3">
                  <div class="card card-border">
                    <img class="card-img-top" src="{{ each.image.url }}" alt="Card image cap">
                    <div class="wear">
                      <p class="d-inline-block">{{ each.description }}</p>
                      <i class="pl-5 fas fa-angle-right"></i>
                    </div>
                  </div>
                </div>
            {% endfor %}
            <div class="col-md-12 col-lg-6 col-sm-12 col-xs-6">
              <div class="row">
              {% for each in category_banner %}
                {% if forloop.counter > 1 %}
                  <div class="col-md-6 col-sm-8 col-lg-6 col-xs-6 mb-3">
                    <div class="card card-border">
                      <img class="card-img-top" src="{{ each.image.url }}" alt="Card image cap">
                      <div class="wear-clothes">
                        <p class="d-inline-block">{{ each.description }}</p>
                        <i class="pl-5 fas fa-angle-right"></i>
                      </div>
                    </div>
                  </div>
                  {% endif %}
              {% endfor %}
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </section>
    <!-- Banner image----------------- -->
    <section> 
      {% if custome_shirt_banner %}
        {% for each in custome_shirt_banner %}
          <div class="container section_banner">
            <div class="banner-image">
              <a href="/customeshirt"><img src="{{ each.image.url }}" class="banner-image" alt=""></a>
              <div class=d-flex>
                <!-- <div>
                  <p class="disc-20">20%</p>
                </div> -->
                <!-- <div class="disc-main">
                  <p class="text-white disc-text-1">Discount</p>
                  <p class="disc-text-2">on Customised T-shirts</p>
                </div> -->
              </div>
              <!-- <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12">
                <button class="shop-btn" type="button" value="">Shop Now</button>
              </div> -->
            </div>
          </div>
        {% endfor %}
      {% endif %}
  </div>
  </section>
  <!-- cards above footer----------------- -->
  <section>
    <div class="bg-service-box">
      <div class="container">
        <div class="row">
          <div class="col-md-3 col-sm-6">
            <div class="serviceBox">
              <div class="service-icon text-center">
                <span><i class="fas fa-palette"></i></span>
              </div>
              <p class="title text-center">Unique Everything</p>
              <p class="description text-center">We have millions of one-of-a kind items in our shop</p>
            </div>
          </div>
          <div class="col-md-3 col-sm-6">
            <div class="serviceBox">
              <div class="service-icon text-center">
                <span><i class="fas fa-shipping-fast"></i></span>
              </div>
              <p class="title text-center">Free Shipping and Return</p>
              <p class="description text-center">We offer free shipping on all domestic orders</p>
            </div>
          </div>
          <div class="col-md-3 col-sm-6">
            <div class="serviceBox">
              <div class="service-icon text-center">
                <span><i class="fas fa-lock"></i></span>
              </div>
              <p class="title text-center">Secure Payments</p>
              <p class="description text-center">Your information is transmitted in a safe mode when shopping</p>
            </div>
          </div>
          <div class="col-md-3 col-sm-6">
            <div class="serviceBox">
              <div class="service-icon text-center">
                <span><i class="fas fa-comment-alt"></i></span>
              </div>
              <p class="title text-center">Support Customer</p>
              {% if our_contact_info %}
                <p class="description text-center">Take care for you all about the detail, call <span><a href="tel:{{ our_contact_info.mobile_no }}">{{ our_contact_info.mobile_no }}</a></span></p>
              {% else %}
                <p class="description text-center">Take care for you all about the detail, call <span><a href="tel:+134 555 666">+134 555 666</a></span></p>
              {% endif %}

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.3.5/js/swiper.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web-animations/2.3.1/web-animations.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/smooth-scrollbar/8.3.1/smooth-scrollbar.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
  crossorigin="anonymous"></script>
  <script src="https://npmcdn.com/flickity@2/dist/flickity.pkgd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.10.1/dist/sweetalert2.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js"></script>
  <script>
const today = new Date()
let tomorrow =  new Date()
tomorrow.setDate(today.getDate() + 2)
function updateTimer() {
  future  = tomorrow;
  now     = new Date();
  diff    = future - now;

  days  = Math.floor( diff / (1000*60*60*24) );
  hours = Math.floor( diff / (1000*60*60) );
  mins  = Math.floor( diff / (1000*60) );
  secs  = Math.floor( diff / 1000 );

  d = days;
  h = hours - days  * 24;
  m = mins  - hours * 60;
  s = secs  - mins  * 60;

  document.getElementById("timer")
    .innerHTML =
      '<div>' + d.toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping: false}) + '<span>DAY</span></div>' +
      '<div>' + h.toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping: false}) + '<span>HOURS</span></div>' +
      '<div>' + m.toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping: false}) + '<span>MINS</span></div>' +
      '<div>' + s.toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping: false}) + '<span>SEC</span></div>' ;
}
setInterval('updateTimer()', 1000 );
// updateTimer();

    let countDownBox	= document.querySelector(".allTime");
		let daysBox			= document.querySelector(".days");
		let hrsBox			= document.querySelector(".hrs");
		let minBox			= document.querySelector(".min");
		let secBox			= document.querySelector(".sec");
		let countDownDate	= new Date (document.sale_end_date).getTime()

		// COUNT DOWN FUNCTION
		let x = setInterval(function() {

			// GET DATE
			let now = new Date().getTime();

			// TIME BETWEEN NOW AND DATE
			let distance = countDownDate - now;

			// CALCULATION TIME
			let days 	= Math.floor(distance / (1000 * 60 * 60 * 24));
			let hours 	= Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
			let minutes	= Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
			let seconds	= Math.floor((distance % (1000 * 60)) / 1000);

			daysBox.innerHTML	= days + "<span>DAY</span>";
			hrsBox.innerHTML 	= hours + "<span>HOURS</span>";
			minBox.innerHTML 	= minutes + "<span>MINS</span>";
			secBox.innerHTML 	= seconds + "<span>SEC</span>";

			// IF FINISH
			if (distance < 0) {
				clearInterval(x);
				countDownBox.innerHTML = "";
			}
		}, 1000);

      jQuery('.card-slider').slick({
  slidesToShow:4,
  autoplay: false,
  slidesToScroll:4,
  dots: false,
  prevArrow:"<button type='button' class='slick-prev pull-left'><i class='fa fa-angle-left' aria-hidden='true'></i></button>",
            nextArrow:"<button type='button' class='slick-next pull-right'><i class='fa fa-angle-right' aria-hidden='true'></i></button>",
  responsive:[
  {
  breakpoint: 768,
  settings: {
    slidesToShow: 2
  }
  },
  {
  breakpoint: 600,
  settings: {
    slidesToShow: 1
  }
  }
  ]
  });
  
  let cards = document.querySelectorAll('.card');
  let card;
  let modal = document.querySelector('.modal');
  let closeButton = document.querySelector('.modal__close-button');
  let page = document.querySelector('.page');
  const cardBorderRadius = 20;
  const openingDuration = 600; //ms
  const closingDuration = 600; //ms
  const timingFunction = 'cubic-bezier(.76,.01,.65,1.38)';
  
  var Scrollbar = window.Scrollbar;
  Scrollbar.init(document.querySelector('.modal__scroll-area'));
  
  
  function flipAnimation(first, last, options) {
  let firstRect = first.getBoundingClientRect();
  let lastRect = last.getBoundingClientRect();
  
  let deltas = {
  top: firstRect.top - lastRect.top,
  left: firstRect.left - lastRect.left,
  width: firstRect.width / lastRect.width,
  height: firstRect.height / lastRect.height
  };
  
  return last.animate([{
  transformOrigin: 'top left',
  borderRadius:`
  ${cardBorderRadius/deltas.width}px / ${cardBorderRadius/deltas.height}px`,
  transform: `
  translate(${deltas.left}px, ${deltas.top}px) 
  scale(${deltas.width}, ${deltas.height})
  `
  },{
  transformOrigin: 'top left',
  transform: 'none',
  borderRadius: `${cardBorderRadius}px`
  }],options);
  }
  
  cards.forEach((item)=>{
  item.addEventListener('click',(e)=>{
  jQuery('.card-slider').slick('slickPause');
  card = e.currentTarget;
  page.dataset.modalState = 'opening';
  card.classList.add('card--opened');
  card.style.opacity = 0;
  document.querySelector('body').classList.add('no-scroll');
  
  let animation = flipAnimation(card,modal,{
  duration: openingDuration,
  easing: timingFunction,
  fill:'both'
  });
  
  animation.onfinish = ()=>{
  page.dataset.modalState = 'open';
  animation.cancel();
  };
  });
  });
  
  closeButton.addEventListener('click',(e)=>{
  page.dataset.modalState = 'closing';
  document.querySelector('body').classList.remove('no-scroll');
  
  let animation = flipAnimation(card,modal,{
  duration: closingDuration,
  easing: timingFunction,
  direction: 'reverse',
  fill:'both'
  });
  
  animation.onfinish = ()=>{
  page.dataset.modalState = 'closed';
  card.style.opacity = 1;
  card.classList.remove('card--opened');
  jQuery('.card-slider').slick('slickPlay');
  animation.cancel();
  };
  });
  </script>
{% endblock content %}